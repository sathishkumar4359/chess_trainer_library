<script>
    async function loadMenu() {
        const grid = document.getElementById('menuGrid');
        const USER = "sathishkumar4359"; 
        const REPO = "chess_trainer_library"; 

        try {
            const url = `https://api.github.com/repos/${USER}/${REPO}/contents/openings`;
            const response = await fetch(url);
            const files = await response.json();
            grid.innerHTML = '';

            for (const file of files) {
                if (!file.name.endsWith('.json')) continue;
                const contentRes = await fetch(file.download_url);
                const rawText = await contentRes.text();
                
                let data;
                try { data = JSON.parse(rawText); } 
                catch(e) { data = [{ name: file.name.replace('.json',''), raw: rawText }]; }

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `<h3>${data[0].name || file.name}</h3>`;
                card.onclick = () => {
                    localStorage.setItem('active_opening', JSON.stringify(data));
                    window.location.href = 'board.html';
                };
                grid.appendChild(card);
            }
        } catch (e) { console.error("Error loading library", e); }
    }
    window.onload = loadMenu;
</script>
